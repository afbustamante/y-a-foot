<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="net.andresbustamante.yafoot.dao.CarDAO">

  <select id="findCarById" resultType="net.andresbustamante.yafoot.model.Voiture">
    SELECT voi_id         AS id,
           voi_nom        AS nom,
           voi_num_places AS nbPlaces
    FROM t_voiture
    WHERE voi_id = #{id}
  </select>

  <insert id="saveCar" useGeneratedKeys="true">
    <selectKey keyProperty="voiture.id" resultType="int" order="BEFORE">
      SELECT NEXTVAL('s_voiture') AS id;
    </selectKey>

    INSERT INTO t_voiture (voi_id, voi_nom, voi_num_places, voi_chauffeur_fk)
    VALUES (#{voiture.id}, #{voiture.nom}, #{voiture.nbPlaces}, #{joueur.id})
  </insert>

  <delete id="deleteCarsForPlayer">
    DELETE
    FROM t_voiture
    WHERE voi_chauffeur_fk = #{joueur.id}
  </delete>

  <select id="findCarsByPlayer" resultType="net.andresbustamante.yafoot.model.Voiture">
    SELECT
      voi_id         AS id,
      voi_nom        AS nom,
      voi_num_places AS nbPlaces
    FROM t_voiture
    WHERE voi_chauffeur_fk = #{joueur.id}
  </select>
</mapper>