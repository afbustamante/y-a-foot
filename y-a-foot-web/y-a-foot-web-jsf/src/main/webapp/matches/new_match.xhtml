<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:ace="http://www.icefaces.org/icefaces/components"
                xmlns:f="http://java.sun.com/jsf/core"
                template="../resources/facelets/general.xhtml">

    <ui:define name="content">
        <h3><h:outputText value="#{messages['new.match.wish.text']}"/></h3>

        <h:form>
            <h:messages errorClass="error" styleClass="messages"/>

            <ace:panel header="#{messages['new.match.details.title']}">
                <h:panelGrid columns="3">
                    <h:outputLabel id="lblDate" for="date" value="#{messages['new.match.date']}" />
                    <ace:dateTimeEntry id="date" required="true" value="#{newMatchBean.dateMatch}"
                                       locale="#{newMatchBean.locale}" pattern="#{newMatchBean.patternDate}"
                                       showButtonPanel="true"
                                       renderAsPopup="true" style="width:200px"
                                       readOnlyInputText="true" minDateTime="#{newMatchBean.maintenant}"
                                       requiredIndicator="*" indicatorPosition="labelRight"
                                       requiredMessage="#{messages['new.match.date.required']}"/>
                    <h:outputText value="" />

                    <h:outputLabel id="lblTime" for="time" value="#{messages['new.match.time']}" />
                    <ace:maskedEntry id="time" value="#{newMatchBean.heureMatch}" mask="99:99" size="5"
                                     requiredIndicator="*" indicatorPosition="labelRight"
                                     requiredMessage="#{messages['new.match.time.required']}"
                                     validatorMessage="#{messages['new.match.time.invalid']}">
                        <f:validateRegex pattern="^(00|[0-9]|1[0-9]|2[0-3]):([0-9]|[0-5][0-9])$" />
                    </ace:maskedEntry>
                    <h:outputText value="" />

                    <h:outputLabel id="lblPlayersMin" for="playersMin" value="#{messages['new.match.players.min']}" />
                    <ace:textEntry id="playersMin" value="#{newMatchBean.numMinJoueurs}" required="true"
                                   requiredIndicator="*" indicatorPosition="labelRight"
                                   requiredMessage="#{messages['new.match.players.required']}"
                                   min="0" max="22" maxlength="2" size="5">
                        <f:validateLongRange minimum="0"/>
                    </ace:textEntry>
                    <h:outputText value="" />

                    <h:outputLabel id="lblPlayersMax" for="playersMax" value="#{messages['new.match.players.max']}" />
                    <ace:textEntry id="playersMax" value="#{newMatchBean.numMaxJoueurs}"
                                   min="0" max="22" maxlength="2" size="5">
                        <f:validateLongRange minimum="0"/>
                    </ace:textEntry>
                    <h:outputText value="" />

                    <h:outputLabel id="lblPlace" for="place" value="#{messages['new.match.place.name']}" />
                    <ace:selectMenu id="place" value="#{newMatchBean.idSite}" required="true"
                                    requiredIndicator="*" indicatorPosition="labelRight"
                                    requiredMessage="#{messages['new.match.place.required']}">
                        <f:selectItem noSelectionOption="true" itemValue="" itemLabel=""/>
                        <f:selectItems value="#{newMatchBean.itemsSites}"/>
                    </ace:selectMenu>
                    <ace:menuButton value="#{messages['button.more']}">
                        <ace:menuItem id="btnAddPlace" value="#{messages['new.match.place.new']}" icon="ui-icon ui-icon-plusthick"
                                      actionListener="#{newMatchBean.afficherDialogNouveauSite}">
                            <ace:ajax event="activate" execute="@this" render="dialogNewPlace" />
                        </ace:menuItem>
                    </ace:menuButton>

                    <ace:dialog id="dialogNewPlace" header="#{messages['new.match.place.new']}" width="500"
                                visible="#{newMatchBean.nouveauSite}" closable="false" modal="true" draggable="false"
                                showEffect="clip" hideEffect="fade">
                        <h:form>
                            <h:panelGrid columns="1">
                                <ace:textEntry id="placeName" value="#{newMatchBean.nomSite}" maxlength="255"
                                               label="#{messages['new.match.place.name']}" labelPosition="top"/>
                                <ace:textAreaEntry id="placeAddress" value="#{newMatchBean.adresseSite}" maxlength="255"
                                                   rows="3" cols="40"
                                                   label="#{messages['new.match.place.address']}" labelPosition="top"/>
                                <ace:textEntry id="placePhoneNumber" value="#{newMatchBean.telephoneSite}"
                                               maxlength="15"
                                               label="#{messages['new.match.place.phone.number']}" labelPosition="top"/>
                            </h:panelGrid>
                            <h:panelGrid columns="2">
                                <ace:pushButton id="submitSite" value="#{messages['button.continue']}"
                                                actionListener="#{newMatchBean.ajouterNouveauSite}">
                                    <ace:ajax execute="@form" render="@all" />
                                </ace:pushButton>
                                <ace:pushButton id="cancelSite" value="#{messages['button.cancel']}"
                                                actionListener="#{newMatchBean.fermerDialogNouveauSite}">
                                    <ace:ajax execute="@form" render="@all" />
                                </ace:pushButton>
                            </h:panelGrid>
                        </h:form>
                    </ace:dialog>
                </h:panelGrid>
            </ace:panel>

            <ace:panel id="advancedOptions" header="#{messages['new.match.options.title']}">
                <h:panelGrid columns="1">
                    <ace:checkboxButton value="#{newMatchBean.optionCovoiturageActive}"
                                        label="#{messages['new.match.option.carpooling']}" labelPosition="right"/>

                    <ace:checkboxButton value="#{newMatchBean.optionInvitationPubliqueActive}"
                                        label="#{messages['new.match.option.open.invitations']}" labelPosition="right"/>
                </h:panelGrid>
            </ace:panel>

            <ace:panel id="actions" styleClass="actions">
                <h:panelGrid columns="2">
                    <ace:pushButton action="#{newMatchBean.creerNouveauMatch}" value="#{messages['button.continue']}"/>
                    <ace:pushButton action="/start" value="#{messages['button.cancel']}"/>
                </h:panelGrid>
            </ace:panel>
        </h:form>
    </ui:define>

</ui:composition>